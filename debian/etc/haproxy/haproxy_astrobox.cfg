global
        maxconn 4096
        user haproxy
        group haproxy
        daemon
        log 127.0.0.1 local0 notice
        errorfile 503 /etc/haproxy/errors/503.http

defaults
        log     global
        mode    http
        option  httplog
        option  dontlognull
        retries 5
        option redispatch
        option http-server-close
        option forwardfor
        maxconn 2000
        timeout connect 10s
        timeout client  15min
        timeout server  15min

frontend public
        bind *:80
        default_backend astrobox

backend astrobox
        reqrep ^([^\ :]*)\ /octoprint/(.*)     \1\ /\2
        option forwardfor
        server astrobox1 127.0.0.1:5000
